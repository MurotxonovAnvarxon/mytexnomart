import 'package:flutter/material.dart';import 'package:flutter_bloc/flutter_bloc.dart';import 'package:google_fonts/google_fonts.dart';import 'package:mytexnomart/bloc/favourite/favourite_bloc.dart';import 'package:mytexnomart/data/source/model/data/special_product_item_data.dart';import 'package:mytexnomart/data/source/model/data/special_product_item_data.dart';import '../../bloc/basket/basket_bloc.dart';import '../basket_screen/basket.dart';class FavouritePage extends StatefulWidget {  const FavouritePage({Key? key}) : super(key: key);  @override  State<FavouritePage> createState() => _FavouritePageState();}class _FavouritePageState extends State<FavouritePage> {  final _bloc = FavouriteBloc();  List<SpecialItemData> data = [];  @override  void initState() {    _bloc.add(GetAllFavouriteEvent());    super.initState();  }  // double calculateTotalSum(List<SpecialItemData> products) {  //   double totalSum = 0;  //   for (var product in products) {  //     totalSum += (double.tryParse(product.value) ?? 0) * (double.tryParse(product.price) ?? 0);  //   }  //   return totalSum;  // }  @override  Widget build(BuildContext context) {    return BlocProvider.value(      value: _bloc,      child: BlocConsumer<FavouriteBloc, FavouriteState>(        listener: (context, state) {          if (state is GetAllProductsFromFavouriteState) {            setState(() {              data = List.from(state.data);            });          }        },        builder: (context, state) {          return Scaffold(            body: SafeArea(              child: Column(                children: [                  Expanded(                    child: Padding(                      padding: const EdgeInsets.all(10),                      child: Builder(                        builder: (context) {                          if (state is GetAllProductsFromFavouriteState) {                            return ListView.builder(                              itemCount: data.length,                              itemBuilder: (context, index) {                                return BasketItem(                                  product: data[index],                                  onDelete: () {                                    // Удаление продукта из корзины                                    _bloc.add(DeleteProductFromFavouriteEvent(                                        product: data[index]));                                  },                                );                              },                            );                          } else {                            return const Center(                              child: CircularProgressIndicator(),                            );                          }                        },                      ),                    ),                  ),                  // const SizedBox(height: 10),                  // const Row(                  //   mainAxisAlignment: MainAxisAlignment.spaceBetween,                  //   children: [                  //     Padding(                  //       padding: EdgeInsets.only(left: 12.0),                  //       child: Text(                  //         "Barchasi:",                  //         style: TextStyle(                  //           fontWeight: FontWeight.w700,                  //           fontSize: 20,                  //         ),                  //       ),                  //     ),                  //     Padding(                  //       padding: EdgeInsets.only(right: 8.0),                  //     ),                  //   ],                  // ),                  // Padding(                  //   padding: const EdgeInsets.symmetric(horizontal: 8.0),                  //   child: Container(                  //     height: 50,                  //     width: MediaQuery.of(context).size.width,                  //     decoration: ShapeDecoration(                  //       color: const Color(0xFFffc300),                  //       shape: RoundedRectangleBorder(                  //         borderRadius: BorderRadius.circular(10),                  //       ),                  //     ),                  //     child: Padding(                  //       padding: const EdgeInsets.symmetric(vertical: 15,),                  //       child: InkWell(                  //         onTap: () async {                  //                  //         },                  //         child: Text(                  //           'Buyurtma qilish',                  //           textAlign: TextAlign.center,                  //           style: GoogleFonts.roboto(                  //             color: Colors.black,                  //             fontSize: 18,                  //             fontWeight: FontWeight.w400,                  //             height: 0,                  //           ),                  //         ),                  //       ),                  //     ),                  //   ),                  // ),                  // SizedBox(height: 10),                  // Padding(                  //   padding: const EdgeInsets.symmetric(horizontal: 8.0),                  //   child: Container(                  //   width: MediaQuery.of(context).size.width,                  //   decoration: ShapeDecoration(                  //     color: Colors.black,                  //     shape: RoundedRectangleBorder(                  //       borderRadius: BorderRadius.circular(10),                  //     ),                  //   ),                  //   child: Padding(                  //     padding: const EdgeInsets.symmetric(vertical: 15),                  //     child: InkWell(                  //       onTap: () async {                  //         // Handle Tozalash button tap                  //         // _bloc.add(DeleteBasket());                  //       },                  //       child: Text(                  //         'Tozalash',                  //         textAlign: TextAlign.center,                  //         style: GoogleFonts.roboto(                  //           color: Colors.white,                  //           fontSize: 18,                  //           fontWeight: FontWeight.w400,                  //           height: 0,                  //         ),                  //       ),                  //     ),                  //   ),                  // ),                  // ),                ],              ),            ),          );        },      ),    );  }}